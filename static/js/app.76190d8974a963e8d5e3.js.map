{"version":3,"sources":["webpack:///../lib/createLookupGrid.js","webpack:///../lib/Vector.js","webpack:///../lib/renderTo.js","webpack:///./src/lib/appState.js","webpack:///../lib/streamLineIntegrator.js","webpack:///../index.js","webpack:///../lib/rk4.js","webpack:///../lib/classCheck.js","webpack:///./src/nativeMain.js"],"names":["classCallCheck","__webpack_require__","module","exports","bbox","dSep","bboxSize","Math","max","width","height","cellsCount","ceil","cells","Map","occupyCoordinates","point","x","y","left","Error","top","assertInBounds","rowCoordinate","gridX","row","get","set","colCoordinate","gridY","cell","Cell","getCellByCoordinates","occupy","isTaken","checkCallback","cx","cy","col","currentCellX","cellRow","currentCellY","cellCol","isOutside","floor","this","children","prototype","push","i","length","p","dx","dy","sqrt","Vector","equals","other","add","mulScalar","scalar","normalize","l","distanceTo","canvas","ctx","getContext","a","b","config","beginPath","strokeStyle","transform","boundingBox","moveTo","lineTo","stroke","closePath","pt","tx","ty","streamline","defaultCode","fieldCode","code","error","isImmediate","setCode","newCode","immediate","newVectorField","compileVectorFieldFunction","streamLineGeneratorOptions","vectorField","redraw","dirty","seed","seedPoint","stepsPerIteration","timeStep","dTest","onPointAdded","lineColor","fillColor","window","addEventListener","lastStreamLineRenderer","appState","isDirty","init","c","getIntegrationProximity","setIntegrationProximity","newValue","ratio","getNumber","settingsPanel","dWarning","getFieldDensity","setFieldDensity","getLineColor","setLineColor","r","g","getFillColor","setFillColor","getStepsPerIteration","setStepsPerIteration","getIntegrationTimeStep","setIntegrationTimeStep","collapsed","moveBoundingBox","bounds","newLeft","minX","newTop","minY","newRight","maxX","newBottom","maxY","abs","random","str","defaultValue","parsed","Number","parseFloat","isNaN","innerWidth","innerHeight","clearRect","fillStyle","fillRect","dispose","run","render","getVelocity","Function","creator","e","message","rk4","createLookupGrid","FORWARD","BACKWARD","DONE","isSame","start","grid","points","pos","state","candidate","lastCheckedSeed","ownGrid","next","growForward","shouldPause","notifyPointAdded","growBackward","unshift","forEach","occupyPointInGrid","getStreamline","getNextValidSeed","v","normalizedVectorField","checkDSep","ox","oy","checkDTest","distanceToCandidate","velocity","growByVelocity","timeStepCheck","protoOptions","options","Object","create","assign","console","warn","requiredBoxMessage","assertNumber","size","normalizeBoundingBox","onStreamlineAdded","resolve","nextTimeout","STATE_INIT","finishedStreamlineIntegrators","streamlineIntegrator","createStreamlineIntegrator","disposed","running","setTimeout","nextStep","Promise","assignResolve","clearTimeout","pResolve","initProcessing","STATE_STREAMLINE","continueStreamline","STATE_PROCESS_QUEUE","processQueue","STATE_SEED_STREAMLINE","seedStreamline","STATE_DONE","streamLineCompleted","addStreamLineToQueue","currentStreamLine","validCandidate","shift","isDone","streamLinePoints","renderTo","msg","k1","k2","k3","k4","instance","Constructor","TypeError","document","getElementById","then","bind","catch","oe"],"mappings":"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","file":"static/js/app.76190d8974a963e8d5e3.js","sourcesContent":["var classCallCheck = require('./classCheck');\n\nmodule.exports = createLookupGrid;\n\nvar Cell = function () {\n  function Cell() {\n    classCallCheck(this, Cell);\n\n    this.children = null;\n  }\n\n  Cell.prototype.occupy = function occupy(point) {\n    if (!this.children) this.children = [];\n    this.children.push(point);\n  };\n\n  Cell.prototype.isTaken = function isTaken(x, y, checkCallback) {\n    if (!this.children) return false;\n\n    for (var i = 0; i < this.children.length; ++i) {\n      var p = this.children[i];\n      var dx = p.x - x,\n          dy = p.y - y;\n      var dist = Math.sqrt(dx * dx + dy * dy);\n      if (checkCallback(dist, p)) return true;\n    }\n\n    return false;\n  };\n\n  return Cell;\n}();\n\nfunction createLookupGrid(bbox, dSep) {\n  var bboxSize = Math.max(bbox.width, bbox.height);\n\n  var cellsCount = Math.ceil(bboxSize / dSep);\n\n  var cells = new Map();\n\n  var api = {\n    occupyCoordinates: occupyCoordinates,\n    isTaken: isTaken,\n    isOutside: isOutside\n  };\n\n  return api;\n\n  function isOutside(x, y) {\n    return x < bbox.left || x > bbox.left + bbox.width || \n           y < bbox.top || y > bbox.top + bbox.height;\n  }\n\n  function occupyCoordinates(point) {\n    var x = point.x, y = point.y;\n    getCellByCoordinates(x, y).occupy(point);\n  }\n\n  function isTaken(x, y, checkCallback) {\n    if (!cells) return false;\n\n    var cx = gridX(x);\n    var cy = gridY(y);\n    for (var col = -1; col < 2; ++col) {\n      var currentCellX = cx + col;\n      if (currentCellX < 0 || currentCellX >= cellsCount) continue;\n      \n      var cellRow = cells.get(currentCellX);\n      if (!cellRow) continue;\n\n      for (var row = -1; row < 2; ++row) {\n        var currentCellY = cy + row;\n        if (currentCellY < 0 || currentCellY >= cellsCount) continue;\n\n        var cellCol = cellRow.get(currentCellY);\n        if(!cellCol) continue;\n        if(cellCol.isTaken(x, y, checkCallback)) return true;\n      }\n    }\n\n    return false;\n  }\n\n  function getCellByCoordinates(x, y) {\n    assertInBounds(x, y);\n\n    var rowCoordinate = gridX(x);\n    var row = cells.get(rowCoordinate);\n    if (!row) {\n      row = new Map();\n      cells.set(rowCoordinate, row);\n    }\n    var colCoordinate = gridY(y);\n    var cell = row.get(colCoordinate);\n    if (!cell) {\n      cell = new Cell();\n      row.set(colCoordinate, cell)\n    }\n    return cell;\n  }\n\n  function gridX(x) {\n    return Math.floor(cellsCount * (x - bbox.left)/bboxSize);\n  }\n\n  function gridY(y) {\n    return Math.floor(cellsCount * (y - bbox.top)/bboxSize);\n  }\n\n  function assertInBounds(x, y) {\n    if (bbox.left > x || bbox.left + bboxSize < x ) {\n      throw new Error('x is out of bounds');\n    }\n    if (bbox.top > y || bbox.top + bboxSize < y ) {\n      throw new Error('y is out of bounds');\n    }\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../lib/createLookupGrid.js\n// module id = 0EQ5\n// module chunks = 1","var classCallCheck = require('./classCheck');\n\nvar Vector = function () {\n  function Vector(x, y) {\n    classCallCheck(this, Vector);\n\n    this.x = x;\n    this.y = y;\n  }\n\n  Vector.prototype.equals = function equals(other) {\n    return this.x === other.x && this.y === other.y;\n  };\n\n  Vector.prototype.add = function add(other) {\n    return new Vector(this.x + other.x, this.y + other.y);\n  };\n\n  Vector.prototype.mulScalar = function mulScalar(scalar) {\n    return new Vector(this.x * scalar, this.y * scalar);\n  };\n\n  Vector.prototype.length = function length() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  };\n\n  Vector.prototype.normalize = function normalize() {\n    var l = this.length();\n    this.x /= l;\n    this.y /= l;\n  };\n\n  Vector.prototype.distanceTo = function distanceTo(other) {\n    var dx = other.x - this.x;\n    var dy = other.y - this.y;\n\n    return Math.sqrt(dx * dx + dy * dy);\n  };\n\n  return Vector;\n}();\n\nmodule.exports = Vector;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../lib/Vector.js\n// module id = 7PpZ\n// module chunks = 1","module.exports = renderTo;\n\nfunction renderTo(canvas) {\n  if (!canvas) throw new Error('Canvas is required');\n\n  var ctx = canvas.getContext('2d');\n  var width = canvas.width;\n  var height = canvas.height;\n\n  return onPointAdded;\n\n  function onPointAdded(a, b, config) {\n    ctx.beginPath();\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0.6)';\n    a = transform(a, config.boundingBox);\n    b = transform(b, config.boundingBox);\n    ctx.moveTo(a.x, a.y);\n    ctx.lineTo(b.x, b.y);\n    ctx.stroke();\n    ctx.closePath();\n  }\n\n  function transform(pt, boundingBox) {\n    var tx = (pt.x - boundingBox.left)/boundingBox.width;\n    var ty = (pt.y - boundingBox.top)/boundingBox.height;\n    return {\n      x: tx * width,\n      y: (1 - ty) * height\n    }\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../lib/renderTo.js\n// module id = KCfz\n// module chunks = 1","var streamline = require('../../../index.js');\n\nvar defaultCode = `function getVelocity(p) {\n  var l = Math.sqrt(p.x * p.x + p.y * p.y);\n  return {\n    x: Math.cos(l),\n    y: Math.log(Math.abs(p.x))\n  };\n}`\n\nvar boundingBox = {left: -5, top: -5, width: 10, height: 10}\nvar fieldCode = {\n  code: defaultCode,\n  error: null,\n  isImmediate: false,\n  setCode(newCode, immediate) {\n    var newVectorField = compileVectorFieldFunction(newCode);\n    if (!newVectorField) return; // error\n    fieldCode.error = null;\n    fieldCode.code = newCode;\n    streamLineGeneratorOptions.vectorField = newVectorField;\n    if (immediate) {\n      redraw();\n    } else if (!fieldCode.immediate) {\n      dirty();\n    }\n    fieldCode.immediate = immediate;\n  }\n}\n\nvar streamLineGeneratorOptions = {\n  vectorField: null,\n  seed: seedPoint,\n  boundingBox,\n  stepsPerIteration: 15,\n  timeStep: 0.01,\n  dSep: 0.1,\n  dTest: 0.005,\n  onPointAdded,\n};\n\nvar lineColor = 'rgba(255, 255, 255, 0.6)';\nvar fillColor = 'rgba(27, 41, 74, 1.0)';\n\nwindow.addEventListener('resize', dirty);\n\nvar appState = {\n  isDirty: false,\n  init,\n  fieldCode,\n  redraw,\n\n  getIntegrationProximity() { return streamLineGeneratorOptions.dTest; },\n  setIntegrationProximity(newValue) { \n    var ratio = getNumber(newValue, streamLineGeneratorOptions.dTest);\n    if (ratio <= 0) ratio = 0.001;\n    if (ratio > 1) ratio = 1;\n    streamLineGeneratorOptions.dTest = newValue\n    validateDSepTest();\n    dirty();\n  },\n\n  getFieldDensity() { return streamLineGeneratorOptions.dSep; },\n  setFieldDensity(newValue) { \n    streamLineGeneratorOptions.dSep = getNumber(newValue, streamLineGeneratorOptions.dSep);\n    dirty();\n  },\n\n  getLineColor() { return lineColor },\n  setLineColor(r, g, b, a) { \n    lineColor = `rgba(${r}, ${g}, ${b}, ${a})`; \n    dirty();\n  },\n  getFillColor() { return fillColor; },\n  setFillColor(r, g, b, a) {\n    fillColor = `rgba(${r}, ${g}, ${b}, ${a})`; \n    dirty();\n  },\n  getStepsPerIteration() { return streamLineGeneratorOptions.stepsPerIteration; },\n  setStepsPerIteration(newValue) { \n    streamLineGeneratorOptions.stepsPerIteration = getNumber(newValue, streamLineGeneratorOptions.stepsPerIteration);\n    dirty();\n  },\n\n  getIntegrationTimeStep() { return streamLineGeneratorOptions.timeStep; },\n  setIntegrationTimeStep(newValue) { \n    streamLineGeneratorOptions.timeStep = getNumber(newValue, streamLineGeneratorOptions.timeStep);\n    dirty();\n  },\n  settingsPanel: {\n    collapsed: true\n  },\n  moveBoundingBox,\n  bounds: readBoundsFromBBox(boundingBox),\n}\n\nvar seedPoint = selectSeedPoint();\n\n\nmodule.exports = appState\n\nvar lastStreamLineRenderer;\nvar canvas, ctx, width, height;\n\nfunction init(c) {\n  canvas = c;\n  ctx = canvas.getContext('2d');\n  streamLineGeneratorOptions.vectorField = compileVectorFieldFunction(defaultCode);\n  redraw();\n}\n\nfunction readBoundsFromBBox(bbox) {\n  return {\n    minX: bbox.left,\n    minY: bbox.top,\n    maxX: bbox.left + bbox.width,\n    maxY: bbox.top + bbox.height,\n  }\n}\n\nfunction validateDSepTest() {\n  if (streamLineGeneratorOptions.dTest >= streamLineGeneratorOptions.dSep) {\n    appState.settingsPanel.dWarning = 'Stop distance should be smaller than line distance';\n  } else {\n    appState.settingsPanel.dWarning = '';\n  }\n}\n\nfunction selectSeedPoint() {\n  return {\n    x: boundingBox.left + Math.random() * boundingBox.width,\n    y: boundingBox.top + Math.random() * boundingBox.height\n  }\n}\nfunction moveBoundingBox(bounds) {\n  var newLeft = getNumber(bounds.minX, boundingBox.left);\n  var newTop = getNumber(bounds.minY, boundingBox.top);\n\n  var newRight = getNumber(bounds.maxX, newLeft + boundingBox.width);\n  var newBottom = getNumber(bounds.maxY, newTop + boundingBox.height);\n\n  boundingBox.left = newLeft;\n  boundingBox.top = newTop;\n  boundingBox.width = newRight - newLeft;\n  boundingBox.height =  Math.abs(newTop - newBottom);\n  dirty();\n}\n\nfunction getNumber(str, defaultValue) {\n  var parsed = Number.parseFloat(str);\n  if (Number.isNaN(parsed)) return defaultValue;\n  return parsed;\n}\n\nfunction redraw() {\n  appState.settingsPanel.isDirty = false;\n  width = window.innerWidth;\n  height = window.innerHeight;\n  canvas.width = width;\n  canvas.height = height;\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = fillColor;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  render();\n}\n\nfunction dirty() {\n  appState.settingsPanel.isDirty = true;\n}\n\nfunction render() {\n  if (lastStreamLineRenderer) {\n    lastStreamLineRenderer.dispose();\n    lastStreamLineRenderer = null;\n  }\n\n  lastStreamLineRenderer = streamline(streamLineGeneratorOptions)\n  lastStreamLineRenderer.run();\n}\n\nfunction onPointAdded(a, b) {\n  ctx.beginPath();\n  ctx.strokeStyle = lineColor;\n  a = transform(a);\n  b = transform(b);\n  ctx.moveTo(a.x, a.y);\n  ctx.lineTo(b.x, b.y);\n  ctx.stroke();\n  ctx.closePath();\n  return true;\n}\n\nfunction transform(pt) {\n  var tx = (pt.x - boundingBox.left)/boundingBox.width;\n  var ty = (pt.y - boundingBox.top)/boundingBox.height;\n  // var ar = width/height;\n  //tx /= ar;\n  return {\n    x: tx * width,\n    y: (1 - ty) * height\n  }\n}\n\nfunction compileVectorFieldFunction(code) {\n  try {\n    var creator = new Function(code + '\\nreturn getVelocity;');\n    var getVelocity = creator();\n    getVelocity(seedPoint); // just a test.\n    return getVelocity;\n  } catch (e) {\n    fieldCode.error = e.message;\n    return null;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/appState.js","var Vector = require('./Vector');\nvar rk4 = require('./rk4');\nvar createLookupGrid = require('./createLookupGrid');\n\nvar FORWARD = 1;\nvar BACKWARD = 2;\nvar DONE = 3;\n\nmodule.exports = createStreamlineIntegrator;\n\nfunction createStreamlineIntegrator(start, grid, config) {\n  var points = [start];\n  var pos = start;\n  var state = FORWARD;\n  var candidate = null;\n  var lastCheckedSeed = -1;\n  var ownGrid = createLookupGrid(config.boundingBox, config.timeStep * 0.9);\n\n  return {\n    start: start,\n    next: next,\n    getStreamline: getStreamline,\n    getNextValidSeed: getNextValidSeed\n  }\n\n  function getStreamline() {\n    return points;\n  }\n\n  function getNextValidSeed() {\n    while (lastCheckedSeed < points.length - 1) {\n      lastCheckedSeed += 1;\n\n      var p = points[lastCheckedSeed];\n      var v = normalizedVectorField(p);\n      if (!v) continue;\n      // Check one normal. We just set c = p + n, where n is orthogonal to v.\n      // Since v is unit vector we can multiply it by scaler (config.dSep) to get to the\n      // right point. It is also easy to find normal in 2d: normal to (x, y) is just (-y, x).\n      // You can get it by applying 2d rotation matrix.)\n      var cx = p.x - v.y * config.dSep;\n      var cy = p.y + v.x * config.dSep;\n\n      if (!grid.isOutside(cx, cy) && !grid.isTaken(cx, cy, checkDSep)) {\n        // this will let us check the other side. When we get back\n        // into this method, the point `cx, cy` will be taken (by construction of another streamline)\n        // And we will throw through to the next orthogonal check.\n        lastCheckedSeed -= 1; \n        return new Vector(cx, cy);\n      }\n\n      // Check orthogonal coordinates on the other side (o = p - n).\n      var ox = p.x + v.y * config.dSep;\n      var oy = p.y - v.x * config.dSep;\n      if (!grid.isOutside(ox, oy) && !grid.isTaken(ox, oy, checkDSep)) return new Vector(ox, oy);\n    }\n  }\n\n  function checkDTest(distanceToCandidate) {\n    if (isSame(distanceToCandidate, config.dTest)) return false;\n    return distanceToCandidate < config.dTest;\n  }\n\n  function checkDSep(distanceToCandidate) {\n    if (isSame(distanceToCandidate, config.dSep)) return false;\n\n    return distanceToCandidate < config.dSep;\n  }\n\n  function next() {\n    while(true) {\n      candidate = null;\n      if (state === FORWARD) {\n        var point = growForward();\n        if (point) {\n          points.push(point);\n          ownGrid.occupyCoordinates(point);\n          pos = point;\n          var shouldPause = notifyPointAdded(point);\n          if (shouldPause) return;\n        } else {\n          // Reset position to start, and grow backwards:\n          pos = start;\n          state = BACKWARD;\n        }\n      } \n      if (state === BACKWARD) {\n        var point = growBackward();\n        if (point) {\n          points.unshift(point);\n          pos = point;\n          ownGrid.occupyCoordinates(point);\n\n          var shouldPause = notifyPointAdded(point);\n          if (shouldPause) return;\n        } else {\n          state = DONE;\n        }\n      }\n\n      if (state === DONE) {\n        points.forEach(occupyPointInGrid);\n        return true;\n      }\n    }\n  }\n\n  function occupyPointInGrid(p) {\n    grid.occupyCoordinates(p);\n  }\n\n  function growForward() {\n    var velocity = rk4(pos, config.timeStep, normalizedVectorField);\n    if (!velocity) return; // Hit the singularity.\n\n    return growByVelocity(pos, velocity);\n  }\n\n  function growBackward() {\n    var velocity = rk4(pos, config.timeStep, normalizedVectorField);\n    if (!velocity) return; // Singularity\n    velocity = velocity.mulScalar(-1);\n\n    return growByVelocity(pos, velocity);\n  }\n\n  function growByVelocity(pos, velocity) {\n    candidate = pos.add(velocity);\n    if (grid.isOutside(candidate.x, candidate.y)) return;\n    if (grid.isTaken(candidate.x, candidate.y, checkDTest)) return;\n\n    // did we hit any of our points?\n    if(ownGrid.isTaken(candidate.x, candidate.y, timeStepCheck)) return;\n    // for (var i = 0; i < points.length; ++i) {\n    //   if (points[i].distanceTo(candidate) < config.timeStep * 0.9) return;\n    // }\n\n    return candidate;\n  }\n\n  function timeStepCheck(distanceToCandidate) {\n    return distanceToCandidate < config.timeStep * 0.9;\n  }\n\n  function notifyPointAdded(point) {\n    var shouldPause = false;\n    if (config.onPointAdded) {\n      shouldPause = config.onPointAdded(point, points[state === FORWARD ? points.length - 2 : 1], config);\n    } \n\n    return shouldPause;\n  }\n\n  function normalizedVectorField(p) {\n    var p = config.vectorField(p);\n    if (!p) return; // Assume singularity\n    if (Number.isNaN(p.x) || Number.isNaN(p.y)) return; // Not defined. e.g. Math.log(-1);\n\n    var l = p.x * p.x + p.y * p.y;\n\n    if (l === 0) return; // the same, singularity\n    l = Math.sqrt(l);\n\n    // We need normalized field.\n    return new Vector(p.x/l, p.y/l);\n  }\n}\n\nfunction isSame(a, b) {\n  // to avoid floating point error\n  return Math.abs(a - b) < 1e-4;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../lib/streamLineIntegrator.js\n// module id = R6aK\n// module chunks = 1","/**\n * Computes streamlines of a vector field based on http://web.cs.ucdavis.edu/~ma/SIGGRAPH02/course23/notes/papers/Jobard.pdf\n */\nmodule.exports = computeStreamlines;\nmodule.exports.renderTo = require('./lib/renderTo');\n\nvar Vector = require('./lib/Vector');\nvar createLookupGrid = require('./lib/createLookupGrid');\nvar createStreamlineIntegrator = require('./lib/streamLineIntegrator');\n\nvar STATE_INIT = 0;\nvar STATE_STREAMLINE = 1;\nvar STATE_PROCESS_QUEUE = 2;\nvar STATE_DONE = 3;\nvar STATE_SEED_STREAMLINE = 4;\n\nfunction computeStreamlines(protoOptions) {\n  var options = Object.create(null);\n  if (!protoOptions) throw new Error('Configuration is required to compute streamlines');\n  if (!protoOptions.boundingBox) {\n    console.warn('No bounding box passed to streamline. Creating default one');\n    options.boundingBox = {left: -5, top: -5, width: 10, height: 10};\n  } else {\n    options.boundingBox = {}\n    Object.assign(options.boundingBox, protoOptions.boundingBox);\n  }\n\n  normalizeBoundingBox(options.boundingBox);\n\n  var boundingBox = options.boundingBox\n  options.vectorField = protoOptions.vectorField;\n  options.onStreamlineAdded = protoOptions.onStreamlineAdded;\n  options.onPointAdded = protoOptions.onPointAdded;\n\n  if (!protoOptions.seed) {\n    options.seed = new Vector(\n      Math.random() * boundingBox.width + boundingBox.left,\n      Math.random() * boundingBox.height + boundingBox.top\n    );\n  } else {\n    options.seed = new Vector(protoOptions.seed.x, protoOptions.seed.y);\n  }\n\n  // Separation between streamlines. Naming according to the paper.\n  options.dSep = protoOptions.dSep > 0 ? protoOptions.dSep : 1./Math.max(boundingBox.width, boundingBox.height);\n\n  // When should we stop integrating a streamline.\n  options.dTest = protoOptions.dTest > 0 ? protoOptions.dTest : options.dSep * 0.5;\n\n  // Lookup grid helps to quickly tell if there are points nearby\n  var grid = createLookupGrid(boundingBox, options.dSep);\n\n  // Integration time step.\n  options.timeStep = protoOptions.timeStep > 0 ? protoOptions.timeStep : 0.01;\n  options.stepsPerIteration = protoOptions.stepsPerIteration > 0 ? protoOptions.stepsPerIteration : 10;\n\n  var stepsPerIteration = options.stepsPerIteration;\n  var resolve;\n  var state = STATE_INIT;\n  var finishedStreamlineIntegrators = [];\n  var streamlineIntegrator = createStreamlineIntegrator(options.seed, grid, options);\n  var disposed = false;\n  var running = false;\n  var nextTimeout;\n  // It is asynchronous. If this is used in a browser we don't want to freeze the UI thread.\n  // On the other hand, if you need this to be sync - we can extend the API. Just let me know.\n\n  return {\n    run: run,\n    dispose: dispose\n  } \n\n  function run() {\n    if (running) return;\n    running = true;\n    nextTimeout = setTimeout(nextStep, 0);\n\n    return new Promise(assignResolve)\n  }\n\n  function assignResolve(pResolve) {\n    resolve = pResolve;\n  }\n\n  function dispose() {\n    disposed = true;\n    clearTimeout(nextTimeout);\n  }\n\n  function nextStep() {\n    if (disposed) return;\n\n    for (var i = 0; i < stepsPerIteration; ++i) {\n      if (state === STATE_INIT) initProcessing();\n      if (state === STATE_STREAMLINE) continueStreamline();\n      if (state === STATE_PROCESS_QUEUE) processQueue();\n      if (state === STATE_SEED_STREAMLINE) seedStreamline();\n\n      if (state === STATE_DONE) {\n        resolve(options);\n        return;\n      }\n    }\n\n    nextTimeout = setTimeout(nextStep, 0);\n  }\n\n  function initProcessing() {\n    var streamLineCompleted = streamlineIntegrator.next();\n    if (streamLineCompleted) {\n      addStreamLineToQueue();\n      state = STATE_PROCESS_QUEUE;\n    }\n  }\n\n  function seedStreamline() {\n    var currentStreamLine = finishedStreamlineIntegrators[0];\n\n    var validCandidate = currentStreamLine.getNextValidSeed();\n    if (validCandidate) {\n      streamlineIntegrator = createStreamlineIntegrator(validCandidate, grid, options);\n      state = STATE_STREAMLINE;\n    } else {\n      finishedStreamlineIntegrators.shift();\n      state = STATE_PROCESS_QUEUE;\n    }\n  }\n\n  function processQueue() {\n    if (finishedStreamlineIntegrators.length === 0) {\n      state = STATE_DONE;\n    } else {\n      state = STATE_SEED_STREAMLINE;\n    }\n  }\n\n  function continueStreamline() {\n    var isDone = streamlineIntegrator.next();\n    if (isDone) {\n      addStreamLineToQueue();\n      state = STATE_SEED_STREAMLINE;\n    }\n  }\n\n  function addStreamLineToQueue() {\n    var streamLinePoints = streamlineIntegrator.getStreamline();\n    if (streamLinePoints.length > 1) {\n      finishedStreamlineIntegrators.push(streamlineIntegrator);\n      if (options.onStreamlineAdded) options.onStreamlineAdded(streamLinePoints, options);\n    }\n  }\n}\n\nfunction normalizeBoundingBox(bbox) {\n  var requiredBoxMessage = 'Bounding box {left, top, width, height} is required';\n  if (!bbox) throw new Error(requiredBoxMessage);\n\n  assertNumber(bbox.left, requiredBoxMessage);\n  assertNumber(bbox.top, requiredBoxMessage);\n  if (typeof bbox.size === 'number') {\n    bbox.width = bbox.size;\n    bbox.height = bbox.size;\n  }\n  assertNumber(bbox.width, requiredBoxMessage);\n  assertNumber(bbox.height, requiredBoxMessage);\n\n  if (bbox.width <= 0 || bbox.height <= 0) throw new Error('Bounding box cannot be empty');\n}\n\nfunction assertNumber(x, msg) {\n  if (typeof x !== 'number' || Number.isNaN(x)) throw new Error(msg);\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../index.js\n// module id = S3PC\n// module chunks = 1","/**\n * Performs Runge-Kutta 4th order integration.\n */\nmodule.exports = rk4;\n\nfunction rk4(point, timeStep, getVelocity) {\n  var k1 = getVelocity(point);\n  if (!k1) return;\n  var k2 = getVelocity(point.add(k1.mulScalar(timeStep * 0.5)));\n  if (!k2) return;\n  var k3 = getVelocity(point.add(k2.mulScalar(timeStep * 0.5)));\n  if (!k3) return;\n  var k4 = getVelocity(point.add(k3.mulScalar(timeStep)));\n  if (!k4) return;\n\n  var res = k1.mulScalar(timeStep / 6).add(k2.mulScalar(timeStep/3)).add(k3.mulScalar(timeStep/3)).add(k4.mulScalar(timeStep/6));\n  return res;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../lib/rk4.js\n// module id = Y/iN\n// module chunks = 1","module.exports = function classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n     throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../lib/classCheck.js\n// module id = v3xi\n// module chunks = 1","var appState = require('./lib/appState');\n\nvar canvas = document.getElementById('scene-canvas');\n// Canvas may not be available in test run\nif (canvas) appState.init(canvas);\n\n// Tell webpack to split bundle, and download settings UI later.\nrequire.ensure('@/main.js', () => {\n  // Settings UI is ready, initialize vue.js application\n  require('@/main.js');\n});\n\n\n// WEBPACK FOOTER //\n// ./src/nativeMain.js"],"sourceRoot":""}